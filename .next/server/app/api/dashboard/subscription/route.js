"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/dashboard/subscription/route";
exports.ids = ["app/api/dashboard/subscription/route"];
exports.modules = {

/***/ "@prisma/client/runtime/library.js":
/*!****************************************************!*\
  !*** external "@prisma/client/runtime/library.js" ***!
  \****************************************************/
/***/ ((module) => {

module.exports = require("@prisma/client/runtime/library.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist\\client\\components\\action-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist\\client\\components\\request-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!*********************************************************************************************!*\
  !*** external "next/dist\\client\\components\\static-generation-async-storage.external.js" ***!
  \*********************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\static-generation-async-storage.external.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdashboard%2Fsubscription%2Froute&page=%2Fapi%2Fdashboard%2Fsubscription%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdashboard%2Fsubscription%2Froute.ts&appDir=C%3A%5CUsers%5CGiiT%5CDesktop%5Ccashflow%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CGiiT%5CDesktop%5Ccashflow&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdashboard%2Fsubscription%2Froute&page=%2Fapi%2Fdashboard%2Fsubscription%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdashboard%2Fsubscription%2Froute.ts&appDir=C%3A%5CUsers%5CGiiT%5CDesktop%5Ccashflow%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CGiiT%5CDesktop%5Ccashflow&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_GiiT_Desktop_cashflow_app_api_dashboard_subscription_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/dashboard/subscription/route.ts */ \"(rsc)/./app/api/dashboard/subscription/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/dashboard/subscription/route\",\n        pathname: \"/api/dashboard/subscription\",\n        filename: \"route\",\n        bundlePath: \"app/api/dashboard/subscription/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\GiiT\\\\Desktop\\\\cashflow\\\\app\\\\api\\\\dashboard\\\\subscription\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_GiiT_Desktop_cashflow_app_api_dashboard_subscription_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/dashboard/subscription/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZkYXNoYm9hcmQlMkZzdWJzY3JpcHRpb24lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmRhc2hib2FyZCUyRnN1YnNjcmlwdGlvbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmRhc2hib2FyZCUyRnN1YnNjcmlwdGlvbiUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNHaWlUJTVDRGVza3RvcCU1Q2Nhc2hmbG93JTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNHaWlUJTVDRGVza3RvcCU1Q2Nhc2hmbG93JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQytCO0FBQzVHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2FzaGZsb3ctY29ubmVjdC8/ODJhYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxHaWlUXFxcXERlc2t0b3BcXFxcY2FzaGZsb3dcXFxcYXBwXFxcXGFwaVxcXFxkYXNoYm9hcmRcXFxcc3Vic2NyaXB0aW9uXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9kYXNoYm9hcmQvc3Vic2NyaXB0aW9uL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZGFzaGJvYXJkL3N1YnNjcmlwdGlvblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZGFzaGJvYXJkL3N1YnNjcmlwdGlvbi9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXEdpaVRcXFxcRGVza3RvcFxcXFxjYXNoZmxvd1xcXFxhcHBcXFxcYXBpXFxcXGRhc2hib2FyZFxcXFxzdWJzY3JpcHRpb25cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZGFzaGJvYXJkL3N1YnNjcmlwdGlvbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdashboard%2Fsubscription%2Froute&page=%2Fapi%2Fdashboard%2Fsubscription%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdashboard%2Fsubscription%2Froute.ts&appDir=C%3A%5CUsers%5CGiiT%5CDesktop%5Ccashflow%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CGiiT%5CDesktop%5Ccashflow&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/dashboard/subscription/route.ts":
/*!*************************************************!*\
  !*** ./app/api/dashboard/subscription/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.ts\");\n/* harmony import */ var _lib_payment_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/payment-service */ \"(rsc)/./lib/payment-service.ts\");\n\n\n\n\n\nasync function GET(request) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session?.user?.id) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // Get subscription from database\n        const subscription = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.subscription.findUnique({\n            where: {\n                userId: session.user.id\n            },\n            include: {\n                payments: {\n                    where: {\n                        status: \"COMPLETED\"\n                    },\n                    orderBy: {\n                        createdAt: \"desc\"\n                    },\n                    take: 1\n                }\n            }\n        });\n        if (!subscription) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"No subscription found\",\n                subscription: null\n            }, {\n                status: 200\n            });\n        }\n        // Calculate transactions used this month\n        const transactionsUsed = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.transaction.count({\n            where: {\n                userId: session.user.id,\n                createdAt: {\n                    gte: subscription.currentMonthStart\n                }\n            }\n        });\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            message: \"Subscription retrieved successfully\",\n            subscription: {\n                id: subscription.id,\n                tier: subscription.tier,\n                transactionLimit: subscription.transactionLimit,\n                transactionsUsed: transactionsUsed,\n                monthlyPrice: subscription.monthlyPrice,\n                maxTransactionAmount: subscription.maxTransactionAmount,\n                status: subscription.status,\n                startDate: subscription.startDate,\n                endDate: subscription.endDate,\n                nextRenewalDate: subscription.nextRenewalDate\n            }\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"Dashboard subscription error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            message: \"Failed to fetch subscription details\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session?.user?.id) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const body = await request.json();\n        const { tier } = body;\n        if (!tier) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"Subscription tier is required\"\n            }, {\n                status: 400\n            });\n        }\n        // Define subscription tier details (matching Prisma schema)\n        const tierDetails = {\n            \"LITE_USER\": {\n                tier: \"LITE_USER\",\n                monthlyPrice: 0,\n                transactionLimit: 5,\n                maxTransactionAmount: 50000,\n                overageFee: 2000\n            },\n            \"BASIC_TIER\": {\n                tier: \"BASIC_TIER\",\n                monthlyPrice: 5000,\n                transactionLimit: 15,\n                maxTransactionAmount: 300000,\n                overageFee: 1800\n            },\n            \"STANDARD_TIER\": {\n                tier: \"STANDARD_TIER\",\n                monthlyPrice: 15000,\n                transactionLimit: 25,\n                maxTransactionAmount: 500000,\n                overageFee: 1500\n            },\n            \"PREMIUM_TIER\": {\n                tier: \"PREMIUM_TIER\",\n                monthlyPrice: 60000,\n                transactionLimit: 100,\n                maxTransactionAmount: 1500000,\n                overageFee: 1000\n            },\n            \"BUSINESS_TIER\": {\n                tier: \"BUSINESS_TIER\",\n                monthlyPrice: 200000,\n                transactionLimit: 500,\n                maxTransactionAmount: 5000000,\n                overageFee: 500\n            },\n            \"ENTERPRISE_TIER\": {\n                tier: \"ENTERPRISE_TIER\",\n                monthlyPrice: 0,\n                transactionLimit: 999999,\n                maxTransactionAmount: 999999999,\n                overageFee: 250\n            }\n        };\n        const selectedTier = tierDetails[tier];\n        if (!selectedTier) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"Invalid subscription tier\"\n            }, {\n                status: 400\n            });\n        }\n        // Create subscription record first\n        const subscription = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.subscription.create({\n            data: {\n                userId: session.user.id,\n                tier: selectedTier.tier,\n                monthlyPrice: selectedTier.monthlyPrice,\n                transactionLimit: selectedTier.transactionLimit,\n                maxTransactionAmount: selectedTier.maxTransactionAmount,\n                overageFee: selectedTier.overageFee,\n                status: \"INACTIVE\",\n                currentMonthStart: new Date(),\n                startDate: new Date(),\n                endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n                lastRenewalDate: new Date(),\n                nextRenewalDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)\n            }\n        });\n        // Process payment through MTN Mobile Money\n        const paymentService = _lib_payment_service__WEBPACK_IMPORTED_MODULE_4__.PaymentService.getInstance();\n        const paymentRequest = {\n            amount: selectedTier.monthlyPrice,\n            phoneNumber: session.user.phone,\n            reference: `SUB_${subscription.id}_${Date.now()}`,\n            description: `Subscription payment for ${selectedTier.tier}`,\n            userId: session.user.id\n        };\n        const paymentResult = await paymentService.processPayment(paymentRequest);\n        if (!paymentResult.success) {\n            // Clean up subscription if payment fails\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.subscription.delete({\n                where: {\n                    id: subscription.id\n                }\n            });\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: paymentResult.message,\n                error: true\n            }, {\n                status: 400\n            });\n        }\n        // Create subscription payment record\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.subscriptionPayment.create({\n            data: {\n                subscriptionId: subscription.id,\n                amount: selectedTier.monthlyPrice,\n                paymentMethod: \"MOBILE_MONEY\",\n                status: \"PENDING\",\n                transactionId: paymentResult.transactionId,\n                billingPeriod: `${new Date().getFullYear()}-${new Date().getMonth() + 1}`\n            }\n        });\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            message: \"Subscription initiated successfully\",\n            subscription: {\n                id: subscription.id,\n                tier: subscription.tier,\n                transactionLimit: subscription.transactionLimit,\n                transactionsUsed: 0,\n                monthlyPrice: subscription.monthlyPrice,\n                status: subscription.status,\n                startDate: subscription.startDate,\n                endDate: subscription.endDate,\n                nextRenewalDate: subscription.nextRenewalDate,\n                transactionId: paymentResult.transactionId\n            }\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"Subscription update error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            message: \"Failed to update subscription\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2Rhc2hib2FyZC9zdWJzY3JpcHRpb24vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBdUQ7QUFDWDtBQUNKO0FBQ0g7QUFDaUI7QUFZL0MsZUFBZUssSUFBSUMsT0FBb0I7SUFDNUMsSUFBSTtRQUNGLE1BQU1DLFVBQVUsTUFBTU4sMkRBQWdCQSxDQUFDQyxrREFBV0E7UUFFbEQsSUFBSSxDQUFDSyxTQUFTQyxNQUFNQyxJQUFJO1lBQ3RCLE9BQU9ULGtGQUFZQSxDQUFDVSxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO1lBQWUsR0FDMUI7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLGlDQUFpQztRQUNqQyxNQUFNQyxlQUFlLE1BQU1WLCtDQUFNQSxDQUFDVSxZQUFZLENBQUNDLFVBQVUsQ0FBQztZQUN4REMsT0FBTztnQkFBRUMsUUFBUVQsUUFBUUMsSUFBSSxDQUFDQyxFQUFFO1lBQUM7WUFDakNRLFNBQVM7Z0JBQ1BDLFVBQVU7b0JBQ1JILE9BQU87d0JBQUVILFFBQVE7b0JBQVk7b0JBQzdCTyxTQUFTO3dCQUFFQyxXQUFXO29CQUFPO29CQUM3QkMsTUFBTTtnQkFDUjtZQUNGO1FBQ0Y7UUFFQSxJQUFJLENBQUNSLGNBQWM7WUFDakIsT0FBT2Isa0ZBQVlBLENBQUNVLElBQUksQ0FDdEI7Z0JBQ0VDLFNBQVM7Z0JBQ1RFLGNBQWM7WUFDaEIsR0FDQTtnQkFBRUQsUUFBUTtZQUFJO1FBRWxCO1FBRUEseUNBQXlDO1FBQ3pDLE1BQU1VLG1CQUFtQixNQUFNbkIsK0NBQU1BLENBQUNvQixXQUFXLENBQUNDLEtBQUssQ0FBQztZQUN0RFQsT0FBTztnQkFDTEMsUUFBUVQsUUFBUUMsSUFBSSxDQUFDQyxFQUFFO2dCQUN2QlcsV0FBVztvQkFDVEssS0FBS1osYUFBYWEsaUJBQWlCO2dCQUNyQztZQUNGO1FBQ0Y7UUFFQSxPQUFPMUIsa0ZBQVlBLENBQUNVLElBQUksQ0FDdEI7WUFDRUMsU0FBUztZQUNURSxjQUFjO2dC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UCxjQUFjTyxhQUFhO2dCQUMxQ0MsZUFBZSxDQUFDLEVBQUUsSUFBSW5CLE9BQU9vQixXQUFXLEdBQUcsQ0FBQyxFQUFFLElBQUlwQixPQUFPcUIsUUFBUSxLQUFLLEVBQUUsQ0FBQztZQUMzRTtRQUNGO1FBRUEsT0FBT2hFLGtGQUFZQSxDQUFDVSxJQUFJLENBQ3RCO1lBQ0VDLFNBQVM7WUFDVEUsY0FBYztnQkFDWkosSUFBSUksYUFBYUosRUFBRTtnQkFDbkJrQixNQUFNZCxhQUFhYyxJQUFJO2dCQUN2QkMsa0JBQWtCZixhQUFhZSxnQkFBZ0I7Z0JBQy9DTixrQkFBa0I7Z0JBQ2xCTyxjQUFjaEIsYUFBYWdCLFlBQVk7Z0JBQ3ZDakIsUUFBUUMsYUFBYUQsTUFBTTtnQkFDM0JtQixXQUFXbEIsYUFBYWtCLFNBQVM7Z0JBQ2pDQyxTQUFTbkIsYUFBYW1CLE9BQU87Z0JBQzdCQyxpQkFBaUJwQixhQUFhb0IsZUFBZTtnQkFDN0M0QixlQUFlUCxjQUFjTyxhQUFhO1lBQzVDO1FBQ0YsR0FDQTtZQUFFakQsUUFBUTtRQUFJO0lBR2xCLEVBQUUsT0FBT3NCLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLDhCQUE4QkE7UUFDNUMsT0FBT2xDLGtGQUFZQSxDQUFDVSxJQUFJLENBQ3RCO1lBQUVDLFNBQVM7UUFBZ0MsR0FDM0M7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYXNoZmxvdy1jb25uZWN0Ly4vYXBwL2FwaS9kYXNoYm9hcmQvc3Vic2NyaXB0aW9uL3JvdXRlLnRzP2NiZTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gJ25leHQtYXV0aCdcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnQC9saWIvYXV0aCdcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL3ByaXNtYSdcbmltcG9ydCB7IFBheW1lbnRTZXJ2aWNlIH0gZnJvbSAnQC9saWIvcGF5bWVudC1zZXJ2aWNlJ1xuXG4vLyBNYXAgb2YgdGllciBuYW1lcyB0byBlbnVtIHZhbHVlc1xudHlwZSBUaWVyTWFwID0ge1xuICBMSVRFX1VTRVI6ICdMSVRFX1VTRVInXG4gIEJBU0lDX1RJRVI6ICdCQVNJQ19USUVSJ1xuICBTVEFOREFSRF9USUVSOiAnU1RBTkRBUkRfVElFUidcbiAgUFJFTUlVTV9USUVSOiAnUFJFTUlVTV9USUVSJ1xuICBCVVNJTkVTU19USUVSOiAnQlVTSU5FU1NfVElFUidcbiAgRU5URVJQUklTRV9USUVSOiAnRU5URVJQUklTRV9USUVSJ1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpXG4gICAgXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyPy5pZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6ICdVbmF1dGhvcml6ZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIEdldCBzdWJzY3JpcHRpb24gZnJvbSBkYXRhYmFzZVxuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IHByaXNtYS5zdWJzY3JpcHRpb24uZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyB1c2VySWQ6IHNlc3Npb24udXNlci5pZCB9LFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICBwYXltZW50czoge1xuICAgICAgICAgIHdoZXJlOiB7IHN0YXR1czogJ0NPTVBMRVRFRCcgfSxcbiAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgICAgdGFrZTogMVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIGlmICghc3Vic2NyaXB0aW9uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgXG4gICAgICAgICAgbWVzc2FnZTogJ05vIHN1YnNjcmlwdGlvbiBmb3VuZCcsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uOiBudWxsXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiAyMDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSB0cmFuc2FjdGlvbnMgdXNlZCB0aGlzIG1vbnRoXG4gICAgY29uc3QgdHJhbnNhY3Rpb25zVXNlZCA9IGF3YWl0IHByaXNtYS50cmFuc2FjdGlvbi5jb3VudCh7XG4gICAgICB3aGVyZToge1xuICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgZ3RlOiBzdWJzY3JpcHRpb24uY3VycmVudE1vbnRoU3RhcnRcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IFxuICAgICAgICBtZXNzYWdlOiAnU3Vic2NyaXB0aW9uIHJldHJpZXZlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICBzdWJzY3JpcHRpb246IHtcbiAgICAgICAgICBpZDogc3Vic2NyaXB0aW9uLmlkLFxuICAgICAgICAgIHRpZXI6IHN1YnNjcmlwdGlvbi50aWVyLFxuICAgICAgICAgIHRyYW5zYWN0aW9uTGltaXQ6IHN1YnNjcmlwdGlvbi50cmFuc2FjdGlvbkxpbWl0LFxuICAgICAgICAgIHRyYW5zYWN0aW9uc1VzZWQ6IHRyYW5zYWN0aW9uc1VzZWQsXG4gICAgICAgICAgbW9udGhseVByaWNlOiBzdWJzY3JpcHRpb24ubW9udGhseVByaWNlLFxuICAgICAgICAgIG1heFRyYW5zYWN0aW9uQW1vdW50OiBzdWJzY3JpcHRpb24ubWF4VHJhbnNhY3Rpb25BbW91bnQsXG4gICAgICAgICAgc3RhdHVzOiBzdWJzY3JpcHRpb24uc3RhdHVzLFxuICAgICAgICAgIHN0YXJ0RGF0ZTogc3Vic2NyaXB0aW9uLnN0YXJ0RGF0ZSxcbiAgICAgICAgICBlbmREYXRlOiBzdWJzY3JpcHRpb24uZW5kRGF0ZSxcbiAgICAgICAgICBuZXh0UmVuZXdhbERhdGU6IHN1YnNjcmlwdGlvbi5uZXh0UmVuZXdhbERhdGVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiAyMDAgfVxuICAgIClcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Rhc2hib2FyZCBzdWJzY3JpcHRpb24gZXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBtZXNzYWdlOiAnRmFpbGVkIHRvIGZldGNoIHN1YnNjcmlwdGlvbiBkZXRhaWxzJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpXG4gICAgXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyPy5pZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6ICdVbmF1dGhvcml6ZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IHsgdGllciB9ID0gYm9keVxuXG4gICAgaWYgKCF0aWVyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgbWVzc2FnZTogJ1N1YnNjcmlwdGlvbiB0aWVyIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgc3Vic2NyaXB0aW9uIHRpZXIgZGV0YWlscyAobWF0Y2hpbmcgUHJpc21hIHNjaGVtYSlcbiAgICBjb25zdCB0aWVyRGV0YWlscyA9IHtcbiAgICAgICdMSVRFX1VTRVInOiB7XG4gICAgICAgIHRpZXI6ICdMSVRFX1VTRVInLFxuICAgICAgICBtb250aGx5UHJpY2U6IDAsXG4gICAgICAgIHRyYW5zYWN0aW9uTGltaXQ6IDUsXG4gICAgICAgIG1heFRyYW5zYWN0aW9uQW1vdW50OiA1MDAwMCxcbiAgICAgICAgb3ZlcmFnZUZlZTogMjAwMFxuICAgICAgfSxcbiAgICAgICdCQVNJQ19USUVSJzoge1xuICAgICAgICB0aWVyOiAnQkFTSUNfVElFUicsXG4gICAgICAgIG1vbnRobHlQcmljZTogNTAwMCxcbiAgICAgICAgdHJhbnNhY3Rpb25MaW1pdDogMTUsXG4gICAgICAgIG1heFRyYW5zYWN0aW9uQW1vdW50OiAzMDAwMDAsXG4gICAgICAgIG92ZXJhZ2VGZWU6IDE4MDBcbiAgICAgIH0sXG4gICAgICAnU1RBTkRBUkRfVElFUic6IHtcbiAgICAgICAgdGllcjogJ1NUQU5EQVJEX1RJRVInLFxuICAgICAgICBtb250aGx5UHJpY2U6IDE1MDAwLFxuICAgICAgICB0cmFuc2FjdGlvbkxpbWl0OiAyNSxcbiAgICAgICAgbWF4VHJhbnNhY3Rpb25BbW91bnQ6IDUwMDAwMCxcbiAgICAgICAgb3ZlcmFnZUZlZTogMTUwMFxuICAgICAgfSxcbiAgICAgICdQUkVNSVVNX1RJRVInOiB7XG4gICAgICAgIHRpZXI6ICdQUkVNSVVNX1RJRVInLFxuICAgICAgICBtb250aGx5UHJpY2U6IDYwMDAwLFxuICAgICAgICB0cmFuc2FjdGlvbkxpbWl0OiAxMDAsXG4gICAgICAgIG1heFRyYW5zYWN0aW9uQW1vdW50OiAxNTAwMDAwLFxuICAgICAgICBvdmVyYWdlRmVlOiAxMDAwXG4gICAgICB9LFxuICAgICAgJ0JVU0lORVNTX1RJRVInOiB7XG4gICAgICAgIHRpZXI6ICdCVVNJTkVTU19USUVSJyxcbiAgICAgICAgbW9udGhseVByaWNlOiAyMDAwMDAsXG4gICAgICAgIHRyYW5zYWN0aW9uTGltaXQ6IDUwMCxcbiAgICAgICAgbWF4VHJhbnNhY3Rpb25BbW91bnQ6IDUwMDAwMDAsXG4gICAgICAgIG92ZXJhZ2VGZWU6IDUwMFxuICAgICAgfSxcbiAgICAgICdFTlRFUlBSSVNFX1RJRVInOiB7XG4gICAgICAgIHRpZXI6ICdFTlRFUlBSSVNFX1RJRVInLFxuICAgICAgICBtb250aGx5UHJpY2U6IDAsIC8vIENvbnRhY3QgZm9yIHByaWNpbmdcbiAgICAgICAgdHJhbnNhY3Rpb25MaW1pdDogOTk5OTk5LFxuICAgICAgICBtYXhUcmFuc2FjdGlvbkFtb3VudDogOTk5OTk5OTk5LFxuICAgICAgICBvdmVyYWdlRmVlOiAyNTBcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzZWxlY3RlZFRpZXIgPSB0aWVyRGV0YWlsc1t0aWVyIGFzIGtleW9mIHR5cGVvZiB0aWVyRGV0YWlsc11cbiAgICBpZiAoIXNlbGVjdGVkVGllcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6ICdJbnZhbGlkIHN1YnNjcmlwdGlvbiB0aWVyJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgc3Vic2NyaXB0aW9uIHJlY29yZCBmaXJzdFxuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IHByaXNtYS5zdWJzY3JpcHRpb24uY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgIHRpZXI6IHNlbGVjdGVkVGllci50aWVyIGFzIFRpZXJNYXBba2V5b2YgVGllck1hcF0sXG4gICAgICAgIG1vbnRobHlQcmljZTogc2VsZWN0ZWRUaWVyLm1vbnRobHlQcmljZSxcbiAgICAgICAgdHJhbnNhY3Rpb25MaW1pdDogc2VsZWN0ZWRUaWVyLnRyYW5zYWN0aW9uTGltaXQsXG4gICAgICAgIG1heFRyYW5zYWN0aW9uQW1vdW50OiBzZWxlY3RlZFRpZXIubWF4VHJhbnNhY3Rpb25BbW91bnQsXG4gICAgICAgIG92ZXJhZ2VGZWU6IHNlbGVjdGVkVGllci5vdmVyYWdlRmVlLFxuICAgICAgICBzdGF0dXM6ICdJTkFDVElWRScsXG4gICAgICAgIGN1cnJlbnRNb250aFN0YXJ0OiBuZXcgRGF0ZSgpLFxuICAgICAgICBzdGFydERhdGU6IG5ldyBEYXRlKCksXG4gICAgICAgIGVuZERhdGU6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzMCAqIDI0ICogNjAgKiA2MCAqIDEwMDApLFxuICAgICAgICBsYXN0UmVuZXdhbERhdGU6IG5ldyBEYXRlKCksXG4gICAgICAgIG5leHRSZW5ld2FsRGF0ZTogbmV3IERhdGUoRGF0ZS5ub3coKSArIDMwICogMjQgKiA2MCAqIDYwICogMTAwMClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gUHJvY2VzcyBwYXltZW50IHRocm91Z2ggTVROIE1vYmlsZSBNb25leVxuICAgIGNvbnN0IHBheW1lbnRTZXJ2aWNlID0gUGF5bWVudFNlcnZpY2UuZ2V0SW5zdGFuY2UoKVxuICAgIGNvbnN0IHBheW1lbnRSZXF1ZXN0ID0ge1xuICAgICAgYW1vdW50OiBzZWxlY3RlZFRpZXIubW9udGhseVByaWNlLFxuICAgICAgcGhvbmVOdW1iZXI6IHNlc3Npb24udXNlci5waG9uZSxcbiAgICAgIHJlZmVyZW5jZTogYFNVQl8ke3N1YnNjcmlwdGlvbi5pZH1fJHtEYXRlLm5vdygpfWAsXG4gICAgICBkZXNjcmlwdGlvbjogYFN1YnNjcmlwdGlvbiBwYXltZW50IGZvciAke3NlbGVjdGVkVGllci50aWVyfWAsXG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZFxuICAgIH1cblxuICAgIGNvbnN0IHBheW1lbnRSZXN1bHQgPSBhd2FpdCBwYXltZW50U2VydmljZS5wcm9jZXNzUGF5bWVudChwYXltZW50UmVxdWVzdClcblxuICAgIGlmICghcGF5bWVudFJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAvLyBDbGVhbiB1cCBzdWJzY3JpcHRpb24gaWYgcGF5bWVudCBmYWlsc1xuICAgICAgYXdhaXQgcHJpc21hLnN1YnNjcmlwdGlvbi5kZWxldGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogc3Vic2NyaXB0aW9uLmlkIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBcbiAgICAgICAgICBtZXNzYWdlOiBwYXltZW50UmVzdWx0Lm1lc3NhZ2UsXG4gICAgICAgICAgZXJyb3I6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHN1YnNjcmlwdGlvbiBwYXltZW50IHJlY29yZFxuICAgIGF3YWl0IHByaXNtYS5zdWJzY3JpcHRpb25QYXltZW50LmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIHN1YnNjcmlwdGlvbklkOiBzdWJzY3JpcHRpb24uaWQsXG4gICAgICAgIGFtb3VudDogc2VsZWN0ZWRUaWVyLm1vbnRobHlQcmljZSxcbiAgICAgICAgcGF5bWVudE1ldGhvZDogJ01PQklMRV9NT05FWScsXG4gICAgICAgIHN0YXR1czogJ1BFTkRJTkcnLFxuICAgICAgICB0cmFuc2FjdGlvbklkOiBwYXltZW50UmVzdWx0LnRyYW5zYWN0aW9uSWQsXG4gICAgICAgIGJpbGxpbmdQZXJpb2Q6IGAke25ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKX0tJHtuZXcgRGF0ZSgpLmdldE1vbnRoKCkgKyAxfWBcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBcbiAgICAgICAgbWVzc2FnZTogJ1N1YnNjcmlwdGlvbiBpbml0aWF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgICAgc3Vic2NyaXB0aW9uOiB7XG4gICAgICAgICAgaWQ6IHN1YnNjcmlwdGlvbi5pZCxcbiAgICAgICAgICB0aWVyOiBzdWJzY3JpcHRpb24udGllcixcbiAgICAgICAgICB0cmFuc2FjdGlvbkxpbWl0OiBzdWJzY3JpcHRpb24udHJhbnNhY3Rpb25MaW1pdCxcbiAgICAgICAgICB0cmFuc2FjdGlvbnNVc2VkOiAwLFxuICAgICAgICAgIG1vbnRobHlQcmljZTogc3Vic2NyaXB0aW9uLm1vbnRobHlQcmljZSxcbiAgICAgICAgICBzdGF0dXM6IHN1YnNjcmlwdGlvbi5zdGF0dXMsXG4gICAgICAgICAgc3RhcnREYXRlOiBzdWJzY3JpcHRpb24uc3RhcnREYXRlLFxuICAgICAgICAgIGVuZERhdGU6IHN1YnNjcmlwdGlvbi5lbmREYXRlLFxuICAgICAgICAgIG5leHRSZW5ld2FsRGF0ZTogc3Vic2NyaXB0aW9uLm5leHRSZW5ld2FsRGF0ZSxcbiAgICAgICAgICB0cmFuc2FjdGlvbklkOiBwYXltZW50UmVzdWx0LnRyYW5zYWN0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiAyMDEgfVxuICAgIClcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1N1YnNjcmlwdGlvbiB1cGRhdGUgZXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBtZXNzYWdlOiAnRmFpbGVkIHRvIHVwZGF0ZSBzdWJzY3JpcHRpb24nIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRTZXJ2ZXJTZXNzaW9uIiwiYXV0aE9wdGlvbnMiLCJwcmlzbWEiLCJQYXltZW50U2VydmljZSIsIkdFVCIsInJlcXVlc3QiLCJzZXNzaW9uIiwidXNlciIsImlkIiwianNvbiIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJzdWJzY3JpcHRpb24iLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJ1c2VySWQiLCJpbmNsdWRlIiwicGF5bWVudHMiLCJvcmRlckJ5IiwiY3JlYXRlZEF0IiwidGFrZSIsInRyYW5zYWN0aW9uc1VzZWQiLCJ0cmFuc2FjdGlvbiIsImNvdW50IiwiZ3RlIiwiY3VycmVudE1vbnRoU3RhcnQiLCJ0aWVyIiwidHJhbnNhY3Rpb25MaW1pdCIsIm1vbnRobHlQcmljZSIsIm1heFRyYW5zYWN0aW9uQW1vdW50Iiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsIm5leHRSZW5ld2FsRGF0ZSIsImVycm9yIiwiY29uc29sZSIsIlBPU1QiLCJib2R5IiwidGllckRldGFpbHMiLCJvdmVyYWdlRmVlIiwic2VsZWN0ZWRUaWVyIiwiY3JlYXRlIiwiZGF0YSIsIkRhdGUiLCJub3ciLCJsYXN0UmVuZXdhbERhdGUiLCJwYXltZW50U2VydmljZSIsImdldEluc3RhbmNlIiwicGF5bWVudFJlcXVlc3QiLCJhbW91bnQiLCJwaG9uZU51bWJlciIsInBob25lIiwicmVmZXJlbmNlIiwiZGVzY3JpcHRpb24iLCJwYXltZW50UmVzdWx0IiwicHJvY2Vzc1BheW1lbnQiLCJzdWNjZXNzIiwiZGVsZXRlIiwic3Vic2NyaXB0aW9uUGF5bWVudCIsInN1YnNjcmlwdGlvbklkIiwicGF5bWVudE1ldGhvZCIsInRyYW5zYWN0aW9uSWQiLCJiaWxsaW5nUGVyaW9kIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/dashboard/subscription/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./lib/prisma.ts\");\n\n\n\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            name: \"credentials\",\n            credentials: {\n                phone: {\n                    label: \"Phone\",\n                    type: \"text\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.phone || !credentials?.password) {\n                    throw new Error(\"Phone and password are required\");\n                }\n                let user;\n                try {\n                    user = await _prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({\n                        where: {\n                            phone: credentials.phone\n                        },\n                        include: {\n                            subscription: true,\n                            agentProfile: true\n                        }\n                    });\n                } catch (error) {\n                    console.log(\"Database error during auth, trying without subscription:\", error);\n                    // If there's a schema mismatch, try without including subscription\n                    user = await _prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({\n                        where: {\n                            phone: credentials.phone\n                        }\n                    });\n                }\n                if (!user || !user.password) {\n                    throw new Error(\"Invalid phone or password\");\n                }\n                const isValidPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_1__[\"default\"].compare(credentials.password, user.password);\n                if (!isValidPassword) {\n                    throw new Error(\"Invalid phone or password\");\n                }\n                if (!user.isVerified) {\n                    throw new Error(\"Please verify your account before logging in\");\n                }\n                return {\n                    id: user.id,\n                    phone: user.phone,\n                    email: user.email,\n                    name: user.name,\n                    role: user.role,\n                    image: user.image,\n                    kycCompleted: user.kycCompleted,\n                    subscription: user.subscription,\n                    agentProfile: user.agentProfile\n                };\n            }\n        })\n    ],\n    session: {\n        strategy: \"jwt\",\n        maxAge: 30 * 24 * 60 * 60\n    },\n    callbacks: {\n        async jwt ({ token, user }) {\n            if (user) {\n                token.role = user.role;\n                token.phone = user.phone;\n                token.kycCompleted = user.kycCompleted;\n                token.subscription = user.subscription;\n                token.agentProfile = user.agentProfile;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token) {\n                session.user.id = token.sub;\n                session.user.role = token.role;\n                session.user.phone = token.phone;\n                session.user.kycCompleted = token.kycCompleted;\n                session.user.subscription = token.subscription;\n                session.user.agentProfile = token.agentProfile;\n            }\n            return session;\n        }\n    },\n    pages: {\n        signIn: \"/auth/signin\",\n        error: \"/auth/error\"\n    },\n    secret: process.env.NEXTAUTH_SECRET\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUWpCLElBQUksQ0FBQ0ksWUFBWSxHQUFHa0IsTUFBTWxCLFlBQVk7Z0JBQzlDYSxRQUFRakIsSUFBSSxDQUFDSyxZQUFZLEdBQUdpQixNQUFNakIsWUFBWTtZQUNoRDtZQUNBLE9BQU9ZO1FBQ1Q7SUFDRjtJQUNBTyxPQUFPO1FBQ0xDLFFBQVE7UUFDUm5CLE9BQU87SUFDVDtJQUNBb0IsUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxlQUFlO0FBQ3JDLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYXNoZmxvdy1jb25uZWN0Ly4vbGliL2F1dGgudHM/YmY3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXV0aE9wdGlvbnMgfSBmcm9tICduZXh0LWF1dGgnXG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2NyZWRlbnRpYWxzJ1xuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcydcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vcHJpc21hJ1xuaW1wb3J0IHsgVXNlclJvbGUgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuZXhwb3J0IGNvbnN0IGF1dGhPcHRpb25zOiBOZXh0QXV0aE9wdGlvbnMgPSB7XG4gIHByb3ZpZGVyczogW1xuICAgIENyZWRlbnRpYWxzUHJvdmlkZXIoe1xuICAgICAgbmFtZTogJ2NyZWRlbnRpYWxzJyxcbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIHBob25lOiB7IGxhYmVsOiAnUGhvbmUnLCB0eXBlOiAndGV4dCcgfSxcbiAgICAgICAgcGFzc3dvcmQ6IHsgbGFiZWw6ICdQYXNzd29yZCcsIHR5cGU6ICdwYXNzd29yZCcgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzPy5waG9uZSB8fCAhY3JlZGVudGlhbHM/LnBhc3N3b3JkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQaG9uZSBhbmQgcGFzc3dvcmQgYXJlIHJlcXVpcmVkJylcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1c2VyXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHsgcGhvbmU6IGNyZWRlbnRpYWxzLnBob25lIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgYWdlbnRQcm9maWxlOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgZXJyb3IgZHVyaW5nIGF1dGgsIHRyeWluZyB3aXRob3V0IHN1YnNjcmlwdGlvbjonLCBlcnJvcilcbiAgICAgICAgICAvLyBJZiB0aGVyZSdzIGEgc2NoZW1hIG1pc21hdGNoLCB0cnkgd2l0aG91dCBpbmNsdWRpbmcgc3Vic2NyaXB0aW9uXG4gICAgICAgICAgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHsgcGhvbmU6IGNyZWRlbnRpYWxzLnBob25lIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF1c2VyIHx8ICF1c2VyLnBhc3N3b3JkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHBob25lIG9yIHBhc3N3b3JkJylcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzVmFsaWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKGNyZWRlbnRpYWxzLnBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKVxuXG4gICAgICAgIGlmICghaXNWYWxpZFBhc3N3b3JkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHBob25lIG9yIHBhc3N3b3JkJylcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdXNlci5pc1ZlcmlmaWVkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQbGVhc2UgdmVyaWZ5IHlvdXIgYWNjb3VudCBiZWZvcmUgbG9nZ2luZyBpbicpXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIHBob25lOiB1c2VyLnBob25lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICByb2xlOiB1c2VyLnJvbGUsXG4gICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXG4gICAgICAgICAga3ljQ29tcGxldGVkOiB1c2VyLmt5Y0NvbXBsZXRlZCxcbiAgICAgICAgICBzdWJzY3JpcHRpb246IHVzZXIuc3Vic2NyaXB0aW9uLFxuICAgICAgICAgIGFnZW50UHJvZmlsZTogdXNlci5hZ2VudFByb2ZpbGVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIF0sXG4gIHNlc3Npb246IHtcbiAgICBzdHJhdGVneTogJ2p3dCcsXG4gICAgbWF4QWdlOiAzMCAqIDI0ICogNjAgKiA2MCwgLy8gMzAgZGF5c1xuICB9LFxuICBjYWxsYmFja3M6IHtcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgdXNlciB9KSB7XG4gICAgICBpZiAodXNlcikge1xuICAgICAgICB0b2tlbi5yb2xlID0gdXNlci5yb2xlXG4gICAgICAgIHRva2VuLnBob25lID0gdXNlci5waG9uZVxuICAgICAgICB0b2tlbi5reWNDb21wbGV0ZWQgPSB1c2VyLmt5Y0NvbXBsZXRlZFxuICAgICAgICB0b2tlbi5zdWJzY3JpcHRpb24gPSB1c2VyLnN1YnNjcmlwdGlvblxuICAgICAgICB0b2tlbi5hZ2VudFByb2ZpbGUgPSB1c2VyLmFnZW50UHJvZmlsZVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRva2VuXG4gICAgfSxcbiAgICBhc3luYyBzZXNzaW9uKHsgc2Vzc2lvbiwgdG9rZW4gfSkge1xuICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgIHNlc3Npb24udXNlci5pZCA9IHRva2VuLnN1YiFcbiAgICAgICAgc2Vzc2lvbi51c2VyLnJvbGUgPSB0b2tlbi5yb2xlIGFzIFVzZXJSb2xlXG4gICAgICAgIHNlc3Npb24udXNlci5waG9uZSA9IHRva2VuLnBob25lIGFzIHN0cmluZ1xuICAgICAgICBzZXNzaW9uLnVzZXIua3ljQ29tcGxldGVkID0gdG9rZW4ua3ljQ29tcGxldGVkIGFzIGJvb2xlYW5cbiAgICAgICAgc2Vzc2lvbi51c2VyLnN1YnNjcmlwdGlvbiA9IHRva2VuLnN1YnNjcmlwdGlvblxuICAgICAgICBzZXNzaW9uLnVzZXIuYWdlbnRQcm9maWxlID0gdG9rZW4uYWdlbnRQcm9maWxlXG4gICAgICB9XG4gICAgICByZXR1cm4gc2Vzc2lvblxuICAgIH1cbiAgfSxcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46ICcvYXV0aC9zaWduaW4nLFxuICAgIGVycm9yOiAnL2F1dGgvZXJyb3InXG4gIH0sXG4gIHNlY3JldDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVUXG59XG4iXSwibmFtZXMiOlsiQ3JlZGVudGlhbHNQcm92aWRlciIsImJjcnlwdCIsInByaXNtYSIsImF1dGhPcHRpb25zIiwicHJvdmlkZXJzIiwibmFtZSIsImNyZWRlbnRpYWxzIiwicGhvbmUiLCJsYWJlbCIsInR5cGUiLCJwYXNzd29yZCIsImF1dGhvcml6ZSIsIkVycm9yIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImluY2x1ZGUiLCJzdWJzY3JpcHRpb24iLCJhZ2VudFByb2ZpbGUiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJpc1ZhbGlkUGFzc3dvcmQiLCJjb21wYXJlIiwiaXNWZXJpZmllZCIsImlkIiwiZW1haWwiLCJyb2xlIiwiaW1hZ2UiLCJreWNDb21wbGV0ZWQiLCJzZXNzaW9uIiwic3RyYXRlZ3kiLCJtYXhBZ2UiLCJjYWxsYmFja3MiLCJqd3QiLCJ0b2tlbiIsInN1YiIsInBhZ2VzIiwic2lnbkluIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIk5FWFRBVVRIX1NFQ1JFVCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/mtn-api.ts":
/*!************************!*\
  !*** ./lib/mtn-api.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MTNMobileMoneyAPI: () => (/* binding */ MTNMobileMoneyAPI),\n/* harmony export */   createMTNAPI: () => (/* binding */ createMTNAPI)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n\nclass MTNMobileMoneyAPI {\n    constructor(config){\n        this.accessToken = null;\n        this.tokenExpiry = null;\n        this.config = config;\n    }\n    // Generate access token\n    async getAccessToken() {\n        if (this.accessToken && this.tokenExpiry && new Date() < this.tokenExpiry) {\n            return this.accessToken;\n        }\n        try {\n            const credentials = Buffer.from(`${this.config.apiUser}:${this.config.apiKey}`).toString(\"base64\");\n            const response = await fetch(`${this.config.baseUrl}/collection/token/`, {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Basic ${credentials}`,\n                    \"Ocp-Apim-Subscription-Key\": this.config.subscriptionKey,\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n            if (!response.ok) {\n                throw new Error(`Failed to get access token: ${response.statusText}`);\n            }\n            const data = await response.json();\n            this.accessToken = data.access_token;\n            this.tokenExpiry = new Date(Date.now() + data.expires_in * 1000);\n            return this.accessToken;\n        } catch (error) {\n            console.error(\"MTN API Error - Access Token:\", error);\n            throw new Error(\"Failed to authenticate with MTN API\");\n        }\n    }\n    // Request payment from customer\n    async requestPayment(request) {\n        try {\n            const accessToken = await this.getAccessToken();\n            const referenceId = (0,uuid__WEBPACK_IMPORTED_MODULE_0__[\"default\"])();\n            const response = await fetch(`${this.config.baseUrl}/collection/v1_0/requesttopay`, {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Bearer ${accessToken}`,\n                    \"X-Reference-Id\": referenceId,\n                    \"X-Target-Environment\": this.config.environment,\n                    \"Ocp-Apim-Subscription-Key\": this.config.subscriptionKey,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(request)\n            });\n            if (response.ok) {\n                return {\n                    success: true,\n                    transactionId: referenceId,\n                    status: \"PENDING\"\n                };\n            } else {\n                const errorData = await response.json().catch(()=>({}));\n                return {\n                    success: false,\n                    error: errorData.message || \"Payment request failed\",\n                    reason: errorData.code\n                };\n            }\n        } catch (error) {\n            console.error(\"MTN API Error - Request Payment:\", error);\n            return {\n                success: false,\n                error: \"Network error occurred\"\n            };\n        }\n    }\n    // Check payment status\n    async getPaymentStatus(transactionId) {\n        try {\n            const accessToken = await this.getAccessToken();\n            const response = await fetch(`${this.config.baseUrl}/collection/v1_0/requesttopay/${transactionId}`, {\n                method: \"GET\",\n                headers: {\n                    \"Authorization\": `Bearer ${accessToken}`,\n                    \"X-Target-Environment\": this.config.environment,\n                    \"Ocp-Apim-Subscription-Key\": this.config.subscriptionKey\n                }\n            });\n            if (response.ok) {\n                const data = await response.json();\n                return {\n                    status: data.status,\n                    amount: data.amount,\n                    currency: data.currency,\n                    reason: data.reason\n                };\n            } else {\n                return {\n                    status: \"FAILED\",\n                    reason: \"Unable to check status\"\n                };\n            }\n        } catch (error) {\n            console.error(\"MTN API Error - Get Status:\", error);\n            return {\n                status: \"FAILED\",\n                reason: \"Network error\"\n            };\n        }\n    }\n    // Get account balance\n    async getAccountBalance() {\n        try {\n            const accessToken = await this.getAccessToken();\n            const response = await fetch(`${this.config.baseUrl}/collection/v1_0/account/balance`, {\n                method: \"GET\",\n                headers: {\n                    \"Authorization\": `Bearer ${accessToken}`,\n                    \"X-Target-Environment\": this.config.environment,\n                    \"Ocp-Apim-Subscription-Key\": this.config.subscriptionKey\n                }\n            });\n            if (response.ok) {\n                const data = await response.json();\n                return {\n                    availableBalance: data.availableBalance,\n                    currency: data.currency\n                };\n            }\n            return null;\n        } catch (error) {\n            console.error(\"MTN API Error - Get Balance:\", error);\n            return null;\n        }\n    }\n    // Validate account holder\n    async validateAccountHolder(phoneNumber) {\n        try {\n            const accessToken = await this.getAccessToken();\n            const response = await fetch(`${this.config.baseUrl}/collection/v1_0/accountholder/msisdn/${phoneNumber}/active`, {\n                method: \"GET\",\n                headers: {\n                    \"Authorization\": `Bearer ${accessToken}`,\n                    \"X-Target-Environment\": this.config.environment,\n                    \"Ocp-Apim-Subscription-Key\": this.config.subscriptionKey\n                }\n            });\n            return response.ok;\n        } catch (error) {\n            console.error(\"MTN API Error - Validate Account:\", error);\n            return false;\n        }\n    }\n}\n// Factory function to create MTN API instance\nfunction createMTNAPI() {\n    const config = {\n        subscriptionKey: process.env.MTN_SUBSCRIPTION_KEY || \"\",\n        apiUser: process.env.MTN_API_USER || \"\",\n        apiKey: process.env.MTN_API_KEY || \"\",\n        baseUrl: process.env.MTN_BASE_URL || \"https://sandbox.momodeveloper.mtn.com\",\n        environment: process.env.MTN_ENVIRONMENT || \"sandbox\"\n    };\n    return new MTNMobileMoneyAPI(config);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQyxvQkFBb0IsSUFBSTtRQUNyRDVDLFNBQVMwQyxRQUFRQyxHQUFHLENBQUNFLFlBQVksSUFBSTtRQUNyQzVDLFFBQVF5QyxRQUFRQyxHQUFHLENBQUNHLFdBQVcsSUFBSTtRQUNuQ3pDLFNBQVNxQyxRQUFRQyxHQUFHLENBQUNJLFlBQVksSUFBSTtRQUNyQ3pCLGFBQWEsUUFBU3FCLEdBQUcsQ0FBQ0ssZUFBZSxJQUFpQztJQUM1RTtJQUVBLE9BQU8sSUFBSTFELGtCQUFrQkU7QUFDL0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYXNoZmxvdy1jb25uZWN0Ly4vbGliL210bi1hcGkudHM/NWJhZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJ1xuXG5leHBvcnQgaW50ZXJmYWNlIE1UTkNvbmZpZyB7XG4gIHN1YnNjcmlwdGlvbktleTogc3RyaW5nXG4gIGFwaVVzZXI6IHN0cmluZ1xuICBhcGlLZXk6IHN0cmluZ1xuICBiYXNlVXJsOiBzdHJpbmdcbiAgZW52aXJvbm1lbnQ6ICdzYW5kYm94JyB8ICdwcm9kdWN0aW9uJ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1UTlBheW1lbnRSZXF1ZXN0IHtcbiAgYW1vdW50OiBzdHJpbmdcbiAgY3VycmVuY3k6IHN0cmluZ1xuICBleHRlcm5hbElkOiBzdHJpbmdcbiAgcGF5ZXI6IHtcbiAgICBwYXJ0eUlkVHlwZTogJ01TSVNETidcbiAgICBwYXJ0eUlkOiBzdHJpbmdcbiAgfVxuICBwYXllck1lc3NhZ2U6IHN0cmluZ1xuICBwYXllZU5vdGU6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1UTlBheW1lbnRSZXNwb25zZSB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgdHJhbnNhY3Rpb25JZD86IHN0cmluZ1xuICBzdGF0dXM/OiBzdHJpbmdcbiAgcmVhc29uPzogc3RyaW5nXG4gIGVycm9yPzogc3RyaW5nXG59XG5cbmV4cG9ydCBjbGFzcyBNVE5Nb2JpbGVNb25leUFQSSB7XG4gIHByaXZhdGUgY29uZmlnOiBNVE5Db25maWdcbiAgcHJpdmF0ZSBhY2Nlc3NUb2tlbjogc3RyaW5nIHwgbnVsbCA9IG51bGxcbiAgcHJpdmF0ZSB0b2tlbkV4cGlyeTogRGF0ZSB8IG51bGwgPSBudWxsXG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBNVE5Db25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZ1xuICB9XG5cbiAgLy8gR2VuZXJhdGUgYWNjZXNzIHRva2VuXG4gIHByaXZhdGUgYXN5bmMgZ2V0QWNjZXNzVG9rZW4oKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBpZiAodGhpcy5hY2Nlc3NUb2tlbiAmJiB0aGlzLnRva2VuRXhwaXJ5ICYmIG5ldyBEYXRlKCkgPCB0aGlzLnRva2VuRXhwaXJ5KSB7XG4gICAgICByZXR1cm4gdGhpcy5hY2Nlc3NUb2tlblxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjcmVkZW50aWFscyA9IEJ1ZmZlci5mcm9tKGAke3RoaXMuY29uZmlnLmFwaVVzZXJ9OiR7dGhpcy5jb25maWcuYXBpS2V5fWApLnRvU3RyaW5nKCdiYXNlNjQnKVxuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuY29uZmlnLmJhc2VVcmx9L2NvbGxlY3Rpb24vdG9rZW4vYCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJhc2ljICR7Y3JlZGVudGlhbHN9YCxcbiAgICAgICAgICAnT2NwLUFwaW0tU3Vic2NyaXB0aW9uLUtleSc6IHRoaXMuY29uZmlnLnN1YnNjcmlwdGlvbktleSxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2V0IGFjY2VzcyB0b2tlbjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBkYXRhLmFjY2Vzc190b2tlblxuICAgICAgdGhpcy50b2tlbkV4cGlyeSA9IG5ldyBEYXRlKERhdGUubm93KCkgKyAoZGF0YS5leHBpcmVzX2luICogMTAwMCkpXG4gICAgICBcbiAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ01UTiBBUEkgRXJyb3IgLSBBY2Nlc3MgVG9rZW46JywgZXJyb3IpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBhdXRoZW50aWNhdGUgd2l0aCBNVE4gQVBJJylcbiAgICB9XG4gIH1cblxuICAvLyBSZXF1ZXN0IHBheW1lbnQgZnJvbSBjdXN0b21lclxuICBhc3luYyByZXF1ZXN0UGF5bWVudChyZXF1ZXN0OiBNVE5QYXltZW50UmVxdWVzdCk6IFByb21pc2U8TVROUGF5bWVudFJlc3BvbnNlPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgdGhpcy5nZXRBY2Nlc3NUb2tlbigpXG4gICAgICBjb25zdCByZWZlcmVuY2VJZCA9IHV1aWR2NCgpXG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5jb25maWcuYmFzZVVybH0vY29sbGVjdGlvbi92MV8wL3JlcXVlc3R0b3BheWAsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgICdYLVJlZmVyZW5jZS1JZCc6IHJlZmVyZW5jZUlkLFxuICAgICAgICAgICdYLVRhcmdldC1FbnZpcm9ubWVudCc6IHRoaXMuY29uZmlnLmVudmlyb25tZW50LFxuICAgICAgICAgICdPY3AtQXBpbS1TdWJzY3JpcHRpb24tS2V5JzogdGhpcy5jb25maWcuc3Vic2NyaXB0aW9uS2V5LFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdClcbiAgICAgIH0pXG5cbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgdHJhbnNhY3Rpb25JZDogcmVmZXJlbmNlSWQsXG4gICAgICAgICAgc3RhdHVzOiAnUEVORElORydcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7fSkpXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGVycm9yRGF0YS5tZXNzYWdlIHx8ICdQYXltZW50IHJlcXVlc3QgZmFpbGVkJyxcbiAgICAgICAgICByZWFzb246IGVycm9yRGF0YS5jb2RlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignTVROIEFQSSBFcnJvciAtIFJlcXVlc3QgUGF5bWVudDonLCBlcnJvcilcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ05ldHdvcmsgZXJyb3Igb2NjdXJyZWQnXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ2hlY2sgcGF5bWVudCBzdGF0dXNcbiAgYXN5bmMgZ2V0UGF5bWVudFN0YXR1cyh0cmFuc2FjdGlvbklkOiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgICBzdGF0dXM6IHN0cmluZ1xuICAgIGFtb3VudD86IHN0cmluZ1xuICAgIGN1cnJlbmN5Pzogc3RyaW5nXG4gICAgcmVhc29uPzogc3RyaW5nXG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCB0aGlzLmdldEFjY2Vzc1Rva2VuKClcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS9jb2xsZWN0aW9uL3YxXzAvcmVxdWVzdHRvcGF5LyR7dHJhbnNhY3Rpb25JZH1gLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgICdYLVRhcmdldC1FbnZpcm9ubWVudCc6IHRoaXMuY29uZmlnLmVudmlyb25tZW50LFxuICAgICAgICAgICdPY3AtQXBpbS1TdWJzY3JpcHRpb24tS2V5JzogdGhpcy5jb25maWcuc3Vic2NyaXB0aW9uS2V5LFxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXG4gICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcbiAgICAgICAgICBjdXJyZW5jeTogZGF0YS5jdXJyZW5jeSxcbiAgICAgICAgICByZWFzb246IGRhdGEucmVhc29uXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3RhdHVzOiAnRkFJTEVEJyxcbiAgICAgICAgICByZWFzb246ICdVbmFibGUgdG8gY2hlY2sgc3RhdHVzJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ01UTiBBUEkgRXJyb3IgLSBHZXQgU3RhdHVzOicsIGVycm9yKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHVzOiAnRkFJTEVEJyxcbiAgICAgICAgcmVhc29uOiAnTmV0d29yayBlcnJvcidcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBHZXQgYWNjb3VudCBiYWxhbmNlXG4gIGFzeW5jIGdldEFjY291bnRCYWxhbmNlKCk6IFByb21pc2U8e1xuICAgIGF2YWlsYWJsZUJhbGFuY2U6IHN0cmluZ1xuICAgIGN1cnJlbmN5OiBzdHJpbmdcbiAgfSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCB0aGlzLmdldEFjY2Vzc1Rva2VuKClcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS9jb2xsZWN0aW9uL3YxXzAvYWNjb3VudC9iYWxhbmNlYCwge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YWNjZXNzVG9rZW59YCxcbiAgICAgICAgICAnWC1UYXJnZXQtRW52aXJvbm1lbnQnOiB0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCxcbiAgICAgICAgICAnT2NwLUFwaW0tU3Vic2NyaXB0aW9uLUtleSc6IHRoaXMuY29uZmlnLnN1YnNjcmlwdGlvbktleSxcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhdmFpbGFibGVCYWxhbmNlOiBkYXRhLmF2YWlsYWJsZUJhbGFuY2UsXG4gICAgICAgICAgY3VycmVuY3k6IGRhdGEuY3VycmVuY3lcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNVE4gQVBJIEVycm9yIC0gR2V0IEJhbGFuY2U6JywgZXJyb3IpXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgfVxuXG4gIC8vIFZhbGlkYXRlIGFjY291bnQgaG9sZGVyXG4gIGFzeW5jIHZhbGlkYXRlQWNjb3VudEhvbGRlcihwaG9uZU51bWJlcjogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgdGhpcy5nZXRBY2Nlc3NUb2tlbigpXG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5jb25maWcuYmFzZVVybH0vY29sbGVjdGlvbi92MV8wL2FjY291bnRob2xkZXIvbXNpc2RuLyR7cGhvbmVOdW1iZXJ9L2FjdGl2ZWAsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgJ1gtVGFyZ2V0LUVudmlyb25tZW50JzogdGhpcy5jb25maWcuZW52aXJvbm1lbnQsXG4gICAgICAgICAgJ09jcC1BcGltLVN1YnNjcmlwdGlvbi1LZXknOiB0aGlzLmNvbmZpZy5zdWJzY3JpcHRpb25LZXksXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiByZXNwb25zZS5va1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNVE4gQVBJIEVycm9yIC0gVmFsaWRhdGUgQWNjb3VudDonLCBlcnJvcilcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxufVxuXG4vLyBGYWN0b3J5IGZ1bmN0aW9uIHRvIGNyZWF0ZSBNVE4gQVBJIGluc3RhbmNlXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTVROQVBJKCk6IE1UTk1vYmlsZU1vbmV5QVBJIHtcbiAgY29uc3QgY29uZmlnOiBNVE5Db25maWcgPSB7XG4gICAgc3Vic2NyaXB0aW9uS2V5OiBwcm9jZXNzLmVudi5NVE5fU1VCU0NSSVBUSU9OX0tFWSB8fCAnJyxcbiAgICBhcGlVc2VyOiBwcm9jZXNzLmVudi5NVE5fQVBJX1VTRVIgfHwgJycsXG4gICAgYXBpS2V5OiBwcm9jZXNzLmVudi5NVE5fQVBJX0tFWSB8fCAnJyxcbiAgICBiYXNlVXJsOiBwcm9jZXNzLmVudi5NVE5fQkFTRV9VUkwgfHwgJ2h0dHBzOi8vc2FuZGJveC5tb21vZGV2ZWxvcGVyLm10bi5jb20nLFxuICAgIGVudmlyb25tZW50OiAocHJvY2Vzcy5lbnYuTVROX0VOVklST05NRU5UIGFzICdzYW5kYm94JyB8ICdwcm9kdWN0aW9uJykgfHwgJ3NhbmRib3gnXG4gIH1cblxuICByZXR1cm4gbmV3IE1UTk1vYmlsZU1vbmV5QVBJKGNvbmZpZylcbn1cbiJdLCJuYW1lcyI6WyJ2NCIsInV1aWR2NCIsIk1UTk1vYmlsZU1vbmV5QVBJIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJhY2Nlc3NUb2tlbiIsInRva2VuRXhwaXJ5IiwiZ2V0QWNjZXNzVG9rZW4iLCJEYXRlIiwiY3JlZGVudGlhbHMiLCJCdWZmZXIiLCJmcm9tIiwiYXBpVXNlciIsImFwaUtleSIsInRvU3RyaW5nIiwicmVzcG9uc2UiLCJmZXRjaCIsImJhc2VVcmwiLCJtZXRob2QiLCJoZWFkZXJzIiwic3Vic2NyaXB0aW9uS2V5Iiwib2siLCJFcnJvciIsInN0YXR1c1RleHQiLCJkYXRhIiwianNvbiIsImFjY2Vzc190b2tlbiIsIm5vdyIsImV4cGlyZXNfaW4iLCJlcnJvciIsImNvbnNvbGUiLCJyZXF1ZXN0UGF5bWVudCIsInJlcXVlc3QiLCJyZWZlcmVuY2VJZCIsImVudmlyb25tZW50IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdWNjZXNzIiwidHJhbnNhY3Rpb25JZCIsInN0YXR1cyIsImVycm9yRGF0YSIsImNhdGNoIiwibWVzc2FnZSIsInJlYXNvbiIsImNvZGUiLCJnZXRQYXltZW50U3RhdHVzIiwiYW1vdW50IiwiY3VycmVuY3kiLCJnZXRBY2NvdW50QmFsYW5jZSIsImF2YWlsYWJsZUJhbGFuY2UiLCJ2YWxpZGF0ZUFjY291bnRIb2xkZXIiLCJwaG9uZU51bWJlciIsImNyZWF0ZU1UTkFQSSIsInByb2Nlc3MiLCJlbnYiLCJNVE5fU1VCU0NSSVBUSU9OX0tFWSIsIk1UTl9BUElfVVNFUiIsIk1UTl9BUElfS0VZIiwiTVROX0JBU0VfVVJMIiwiTVROX0VOVklST05NRU5UIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/mtn-api.ts\n");

/***/ }),

/***/ "(rsc)/./lib/payment-service.ts":
/*!********************************!*\
  !*** ./lib/payment-service.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PaymentService: () => (/* binding */ PaymentService)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.ts\");\n/* harmony import */ var _lib_mtn_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/mtn-api */ \"(rsc)/./lib/mtn-api.ts\");\n\n\nclass PaymentService {\n    constructor(){\n        // Initialize MTN API with configuration\n        this.mtnApi = new _lib_mtn_api__WEBPACK_IMPORTED_MODULE_1__.MTNMobileMoneyAPI({\n            baseUrl: process.env.MTN_API_BASE_URL || \"\",\n            apiUser: process.env.MTN_API_USER || \"\",\n            apiKey: process.env.MTN_API_KEY || \"\",\n            subscriptionKey: process.env.MTN_SUBSCRIPTION_KEY || \"\",\n            environment: \"sandbox\"\n        });\n    }\n    static getInstance() {\n        if (!PaymentService.instance) {\n            PaymentService.instance = new PaymentService();\n        }\n        return PaymentService.instance;\n    }\n    async processPayment(request) {\n        try {\n            // Validate payment request\n            if (!request.amount || request.amount <= 0) {\n                return {\n                    success: false,\n                    message: \"Invalid payment amount\"\n                };\n            }\n            // Create subscription payment record\n            const payment = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.subscriptionPayment.create({\n                data: {\n                    subscriptionId: request.userId,\n                    amount: request.amount,\n                    status: \"PENDING\",\n                    paymentMethod: \"MOBILE_MONEY\"\n                }\n            });\n            // Process payment through MTN API\n            const mtnResponse = await this.mtnApi.requestPayment({\n                amount: request.amount.toString(),\n                currency: \"UGX\",\n                externalId: request.reference,\n                payer: {\n                    partyIdType: \"MSISDN\",\n                    partyId: request.phoneNumber\n                },\n                payerMessage: request.description,\n                payeeNote: \"CashFlow Connect Subscription Payment\"\n            });\n            if (!mtnResponse.success) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.subscriptionPayment.update({\n                    where: {\n                        id: payment.id\n                    },\n                    data: {\n                        status: \"FAILED\"\n                    }\n                });\n                return {\n                    success: false,\n                    message: mtnResponse.error || \"Payment failed\"\n                };\n            }\n            // Update payment record with MTN details\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.subscriptionPayment.update({\n                where: {\n                    id: payment.id\n                },\n                data: {\n                    status: \"PENDING\",\n                    transactionId: mtnResponse.transactionId\n                }\n            });\n            return {\n                success: true,\n                message: \"Payment initiated successfully\",\n                transactionId: mtnResponse.transactionId\n            };\n        } catch (error) {\n            console.error(\"Payment processing error:\", error);\n            return {\n                success: false,\n                message: \"Failed to process payment. Please try again later.\"\n            };\n        }\n    }\n    async verifyPayment(transactionId) {\n        try {\n            const payment = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.subscriptionPayment.findUnique({\n                where: {\n                    transactionId\n                },\n                include: {\n                    subscription: true\n                }\n            });\n            if (!payment) {\n                return {\n                    success: false,\n                    message: \"Payment not found\"\n                };\n            }\n            if (payment.status === \"COMPLETED\") {\n                return {\n                    success: true,\n                    message: \"Payment already completed\"\n                };\n            }\n            // Verify with MTN if payment was successful\n            const verification = await this.mtnApi.getPaymentStatus(transactionId);\n            if (verification.status === \"COMPLETED\") {\n                // Update payment status\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.subscriptionPayment.update({\n                    where: {\n                        transactionId\n                    },\n                    data: {\n                        status: \"COMPLETED\"\n                    }\n                });\n                // If this was a subscription payment, update subscription status\n                if (payment.subscriptionId) {\n                    await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.subscription.update({\n                        where: {\n                            id: payment.subscriptionId\n                        },\n                        data: {\n                            status: \"ACTIVE\",\n                            lastRenewalDate: new Date(),\n                            nextRenewalDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)\n                        }\n                    });\n                }\n                return {\n                    success: true,\n                    message: \"Payment verified successfully\"\n                };\n            }\n            return {\n                success: false,\n                message: verification.reason || \"Payment verification failed\"\n            };\n        } catch (error) {\n            console.error(\"Payment verification error:\", error);\n            return {\n                success: false,\n                message: \"Failed to verify payment\"\n            };\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dHM/YmYyYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnXG5pbXBvcnQgeyBNVE5Nb2JpbGVNb25leUFQSSB9IGZyb20gJ0AvbGliL210bi1hcGknXG5cbmV4cG9ydCBpbnRlcmZhY2UgUGF5bWVudFJlcXVlc3Qge1xuICBhbW91bnQ6IG51bWJlclxuICB1c2VySWQ6IHN0cmluZ1xuICBwaG9uZU51bWJlcjogc3RyaW5nXG4gIHJlZmVyZW5jZTogc3RyaW5nXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYXltZW50UmVzcG9uc2Uge1xuICBzdWNjZXNzOiBib29sZWFuXG4gIG1lc3NhZ2U6IHN0cmluZ1xuICB0cmFuc2FjdGlvbklkPzogc3RyaW5nXG59XG5cbmV4cG9ydCBjbGFzcyBQYXltZW50U2VydmljZSB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQYXltZW50U2VydmljZVxuICBwcml2YXRlIG10bkFwaTogTVROTW9iaWxlTW9uZXlBUElcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIEluaXRpYWxpemUgTVROIEFQSSB3aXRoIGNvbmZpZ3VyYXRpb25cbiAgICB0aGlzLm10bkFwaSA9IG5ldyBNVE5Nb2JpbGVNb25leUFQSSh7XG4gICAgICBiYXNlVXJsOiBwcm9jZXNzLmVudi5NVE5fQVBJX0JBU0VfVVJMIHx8ICcnLFxuICAgICAgYXBpVXNlcjogcHJvY2Vzcy5lbnYuTVROX0FQSV9VU0VSIHx8ICcnLFxuICAgICAgYXBpS2V5OiBwcm9jZXNzLmVudi5NVE5fQVBJX0tFWSB8fCAnJyxcbiAgICAgIHN1YnNjcmlwdGlvbktleTogcHJvY2Vzcy5lbnYuTVROX1NVQlNDUklQVElPTl9LRVkgfHwgJycsXG4gICAgICBlbnZpcm9ubWVudDogJ3NhbmRib3gnIGFzIGNvbnN0XG4gICAgfSlcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogUGF5bWVudFNlcnZpY2Uge1xuICAgIGlmICghUGF5bWVudFNlcnZpY2UuaW5zdGFuY2UpIHtcbiAgICAgIFBheW1lbnRTZXJ2aWNlLmluc3RhbmNlID0gbmV3IFBheW1lbnRTZXJ2aWNlKClcbiAgICB9XG4gICAgcmV0dXJuIFBheW1lbnRTZXJ2aWNlLmluc3RhbmNlXG4gIH1cblxuICBhc3luYyBwcm9jZXNzUGF5bWVudChyZXF1ZXN0OiBQYXltZW50UmVxdWVzdCk6IFByb21pc2U8UGF5bWVudFJlc3BvbnNlPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFZhbGlkYXRlIHBheW1lbnQgcmVxdWVzdFxuICAgICAgaWYgKCFyZXF1ZXN0LmFtb3VudCB8fCByZXF1ZXN0LmFtb3VudCA8PSAwKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgcGF5bWVudCBhbW91bnQnXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIHN1YnNjcmlwdGlvbiBwYXltZW50IHJlY29yZFxuICAgICAgY29uc3QgcGF5bWVudCA9IGF3YWl0IHByaXNtYS5zdWJzY3JpcHRpb25QYXltZW50LmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWJzY3JpcHRpb25JZDogcmVxdWVzdC51c2VySWQsXG4gICAgICAgICAgYW1vdW50OiByZXF1ZXN0LmFtb3VudCxcbiAgICAgICAgICBzdGF0dXM6ICdQRU5ESU5HJyxcbiAgICAgICAgICBwYXltZW50TWV0aG9kOiAnTU9CSUxFX01PTkVZJ1xuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBQcm9jZXNzIHBheW1lbnQgdGhyb3VnaCBNVE4gQVBJXG4gICAgICBjb25zdCBtdG5SZXNwb25zZSA9IGF3YWl0IHRoaXMubXRuQXBpLnJlcXVlc3RQYXltZW50KHtcbiAgICAgICAgYW1vdW50OiByZXF1ZXN0LmFtb3VudC50b1N0cmluZygpLFxuICAgICAgICBjdXJyZW5jeTogJ1VHWCcsXG4gICAgICAgIGV4dGVybmFsSWQ6IHJlcXVlc3QucmVmZXJlbmNlLFxuICAgICAgICBwYXllcjoge1xuICAgICAgICAgIHBhcnR5SWRUeXBlOiAnTVNJU0ROJyxcbiAgICAgICAgICBwYXJ0eUlkOiByZXF1ZXN0LnBob25lTnVtYmVyXG4gICAgICAgIH0sXG4gICAgICAgIHBheWVyTWVzc2FnZTogcmVxdWVzdC5kZXNjcmlwdGlvbixcbiAgICAgICAgcGF5ZWVOb3RlOiAnQ2FzaEZsb3cgQ29ubmVjdCBTdWJzY3JpcHRpb24gUGF5bWVudCdcbiAgICAgIH0pXG5cbiAgICAgIGlmICghbXRuUmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICBhd2FpdCBwcmlzbWEuc3Vic2NyaXB0aW9uUGF5bWVudC51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50LmlkIH0sXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgc3RhdHVzOiAnRkFJTEVEJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBtZXNzYWdlOiBtdG5SZXNwb25zZS5lcnJvciB8fCAnUGF5bWVudCBmYWlsZWQnXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVXBkYXRlIHBheW1lbnQgcmVjb3JkIHdpdGggTVROIGRldGFpbHNcbiAgICAgIGF3YWl0IHByaXNtYS5zdWJzY3JpcHRpb25QYXltZW50LnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50LmlkIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdGF0dXM6ICdQRU5ESU5HJyxcbiAgICAgICAgICB0cmFuc2FjdGlvbklkOiBtdG5SZXNwb25zZS50cmFuc2FjdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6ICdQYXltZW50IGluaXRpYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICB0cmFuc2FjdGlvbklkOiBtdG5SZXNwb25zZS50cmFuc2FjdGlvbklkXG4gICAgICB9XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignUGF5bWVudCBwcm9jZXNzaW5nIGVycm9yOicsIGVycm9yKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcHJvY2VzcyBwYXltZW50LiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLidcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyB2ZXJpZnlQYXltZW50KHRyYW5zYWN0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8UGF5bWVudFJlc3BvbnNlPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCBwcmlzbWEuc3Vic2NyaXB0aW9uUGF5bWVudC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgdHJhbnNhY3Rpb25JZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgc3Vic2NyaXB0aW9uOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIGlmICghcGF5bWVudCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIG1lc3NhZ2U6ICdQYXltZW50IG5vdCBmb3VuZCdcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAocGF5bWVudC5zdGF0dXMgPT09ICdDT01QTEVURUQnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBtZXNzYWdlOiAnUGF5bWVudCBhbHJlYWR5IGNvbXBsZXRlZCdcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBWZXJpZnkgd2l0aCBNVE4gaWYgcGF5bWVudCB3YXMgc3VjY2Vzc2Z1bFxuICAgICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgdGhpcy5tdG5BcGkuZ2V0UGF5bWVudFN0YXR1cyh0cmFuc2FjdGlvbklkKVxuXG4gICAgICBpZiAodmVyaWZpY2F0aW9uLnN0YXR1cyA9PT0gJ0NPTVBMRVRFRCcpIHtcbiAgICAgICAgLy8gVXBkYXRlIHBheW1lbnQgc3RhdHVzXG4gICAgICAgIGF3YWl0IHByaXNtYS5zdWJzY3JpcHRpb25QYXltZW50LnVwZGF0ZSh7XG4gICAgICAgICAgd2hlcmU6IHsgdHJhbnNhY3Rpb25JZCB9LFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIHN0YXR1czogJ0NPTVBMRVRFRCdcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gSWYgdGhpcyB3YXMgYSBzdWJzY3JpcHRpb24gcGF5bWVudCwgdXBkYXRlIHN1YnNjcmlwdGlvbiBzdGF0dXNcbiAgICAgICAgaWYgKHBheW1lbnQuc3Vic2NyaXB0aW9uSWQpIHtcbiAgICAgICAgICBhd2FpdCBwcmlzbWEuc3Vic2NyaXB0aW9uLnVwZGF0ZSh7XG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5zdWJzY3JpcHRpb25JZCB9LFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBzdGF0dXM6ICdBQ1RJVkUnLFxuICAgICAgICAgICAgICBsYXN0UmVuZXdhbERhdGU6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIG5leHRSZW5ld2FsRGF0ZTogbmV3IERhdGUoRGF0ZS5ub3coKSArIDMwICogMjQgKiA2MCAqIDYwICogMTAwMClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIG1lc3NhZ2U6ICdQYXltZW50IHZlcmlmaWVkIHN1Y2Nlc3NmdWxseSdcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgbWVzc2FnZTogdmVyaWZpY2F0aW9uLnJlYXNvbiB8fCAnUGF5bWVudCB2ZXJpZmljYXRpb24gZmFpbGVkJ1xuICAgICAgfVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1BheW1lbnQgdmVyaWZpY2F0aW9uIGVycm9yOicsIGVycm9yKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gdmVyaWZ5IHBheW1lbnQnXG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiTVROTW9iaWxlTW9uZXlBUEkiLCJQYXltZW50U2VydmljZSIsIm10bkFwaSIsImJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTVROX0FQSV9CQVNFX1VSTCIsImFwaVVzZXIiLCJNVE5fQVBJX1VTRVIiLCJhcGlLZXkiLCJNVE5fQVBJX0tFWSIsInN1YnNjcmlwdGlvbktleSIsIk1UTl9TVUJTQ1JJUFRJT05fS0VZIiwiZW52aXJvbm1lbnQiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwicHJvY2Vzc1BheW1lbnQiLCJyZXF1ZXN0IiwiYW1vdW50Iiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJwYXltZW50Iiwic3Vic2NyaXB0aW9uUGF5bWVudCIsImNyZWF0ZSIsImRhdGEiLCJzdWJzY3JpcHRpb25JZCIsInVzZXJJZCIsInN0YXR1cyIsInBheW1lbnRNZXRob2QiLCJtdG5SZXNwb25zZSIsInJlcXVlc3RQYXltZW50IiwidG9TdHJpbmciLCJjdXJyZW5jeSIsImV4dGVybmFsSWQiLCJyZWZlcmVuY2UiLCJwYXllciIsInBhcnR5SWRUeXBlIiwicGFydHlJZCIsInBob25lTnVtYmVyIiwicGF5ZXJNZXNzYWdlIiwiZGVzY3JpcHRpb24iLCJwYXllZU5vdGUiLCJ1cGRhdGUiLCJ3aGVyZSIsImlkIiwiZXJyb3IiLCJ0cmFuc2FjdGlvbklkIiwiY29uc29sZSIsInZlcmlmeVBheW1lbnQiLCJmaW5kVW5pcXVlIiwiaW5jbHVkZSIsInN1YnNjcmlwdGlvbiIsInZlcmlmaWNhdGlvbiIsImdldFBheW1lbnRTdGF0dXMiLCJsYXN0UmVuZXdhbERhdGUiLCJEYXRlIiwibmV4dFJlbmV3YWxEYXRlIiwibm93IiwicmVhc29uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/payment-service.ts\n");

/***/ }),

/***/ "(rsc)/./lib/prisma.ts":
/*!***********************!*\
  !*** ./lib/prisma.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _barrel_optimize_names_PrismaClient_prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! __barrel_optimize__?names=PrismaClient!=!@prisma/client */ \"(rsc)/./node_modules/@prisma/client/default.js\");\n/* harmony import */ var _barrel_optimize_names_PrismaClient_prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_barrel_optimize_names_PrismaClient_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _barrel_optimize_names_PrismaClient_prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLFNBQVNGLGdCQUFnQkUsTUFBTSxJQUFJLElBQUlILDJGQUFZQSxHQUFFO0FBRWxFLElBQUlJLElBQXlCLEVBQWNILGdCQUFnQkUsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsid2VicGFjazovL2Nhc2hmbG93LWNvbm5lY3QvLi9saWIvcHJpc21hLnRzPzk4MjIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoKVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYVxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbFRoaXMiLCJwcmlzbWEiLCJwcm9jZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/prisma.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@prisma","vendor-chunks/next-auth","vendor-chunks/jose","vendor-chunks/prisma","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/@babel","vendor-chunks/oauth","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/preact-render-to-string","vendor-chunks/yallist","vendor-chunks/lru-cache","vendor-chunks/cookie","vendor-chunks/oidc-token-hash","vendor-chunks/@panva","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdashboard%2Fsubscription%2Froute&page=%2Fapi%2Fdashboard%2Fsubscription%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdashboard%2Fsubscription%2Froute.ts&appDir=C%3A%5CUsers%5CGiiT%5CDesktop%5Ccashflow%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CGiiT%5CDesktop%5Ccashflow&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();